
# 概述

## 股价预测的意义


股票市场是经济的晴雨表，与国民经济发展密切相关，是投资者信心和国家经济发展潜力的象征和标志。从机器学习的视角来看，股票趋势并非没有规律的随机运动，而是受经济政治等多种外界因素和成交量、企业业绩等众多内部因素综合影响的理性市场活动。股市波动瞬息万变，股票市场的预测和分析与投资者利益息息相关。

机器学习总的来说分为监督学习、非监督学习和强化学习。监督学习可分为“回归”和“分类”问题。在回归问题中，我们会预测一个连续值，也就是说我们试图将输入变量和输出用一个连续函数对应起来；而在分类问题中，我们会预测一个离散值，我们试图将输入变量与离散的类别对应起来。但总的来说，监督学习需要样本数据有“标签”，通过大量数据的学习，让模型在过程中发现不同“标签”对应的特征规律。非监督学习中，给定的数据是和监督学习中给定的数据是不一样的，数据点没有相关的标签，算法的目标是以某种方式组织数据，然后找出数据中存在的内在结构。比如聚类，通过找到更简单的方式处理复杂数据，将复杂数据中的隐含结构发掘出来。强化学习是一种学习模型，AlphaGo使用的就是强化学习模型，与监督和非监督学习不同，它并不是通过大量数据学习内部的特征，而是机器自行与外界环境不停的互动，从而产生数据反馈并获得回报，机器会逐渐趋向于奖励并避免惩罚，在这个过程中不断学习适应外界环境，最终得出最好的行动方案。

股市预测任务并非通过单一的机器学习模型就可以实现准确预测，需要综合多种机器学习模型，充分利用非监督学习挖掘特征潜在结构，利用监督模型对所选特征进行精确拟合，最终通过强化学习方式让机器自行探索合适的模型参数，以收益为反馈，训练机器学习模型以达到准确预测股市波动的效果。综合研究和运用机器学习各种模型并应用于股市预测任务，对于准确判断股市趋势，实现投资收益最大化具有十分重要的理论意义，也是人工智能辅助人类决策的必经之路。

准确预测股票市场中包括股票价格指数和股票价格的运行态势，对于政府宏观管理而言，可以在一定层面上监测和引导股票市场的平稳运行，降低市场风险，从而促进实体经济的健康和平稳增长。

在进行股票投资时，投资者会获得与其承担的风险相对应的回报，预期回报率与风险之间是一种正向的互动关系。因此，对股市和个股进行认真的分析才能降低投资风险，获得投资效益。对于投资者而言，算法得出的预测结果对其做出有效的投资策略有着很好的参考价值，这样可以在一定程度上减少股票市场中盲目投资的现象，减少投资者的损失，降低他们的决策成本，对于提高股票市场中投资者的理性程度有很高的现实意义，也满足了市场上的一大需求。



## 现阶段主流的股价预测模型

### 1.ARIMA模型

ARIMA模型（英语：AutoregressiveIntegratedMovingAverage model），差分整合移动平均自回归模型，又称整合移动平均自回归模型（移动也可称作滑动），时间序列预测分析方法之一。ARIMA（p，d，q）中，AR是"自回归"，p为自回归项数；MA为"滑动平均"，q为滑动平均项数，d为使之成为平稳序列所做的差分次数（阶数）。“差分”一词虽未出现在ARIMA的英文名称中，却是关键步骤。ARIMA 模型是在平稳的时间序列基础上建立起来的，因此时间序列的平稳性是建模的重要前提。检验时间序列模型平稳的方法一般采用 ADF 单位根检验模型去检验。当然如果时间序列不稳定，也可以通过一些操作去使得时间序列稳定（比如取对数，差分），然后进行 ARIMA 模型预测，得到稳定的时间序列的预测结果，然后对预测结果进行之前使序列稳定的操作的逆操作（取指数，差分的逆操作），就可以得到原始数据的预测结果。



### 2.基于随机过程的马尔科夫链模型

马尔科夫过程是研究事物状态以及其状态转移规律的理论，适合于时间序列以及空间序列，一个时间与状态都是离散的马尔科夫过程叫做马尔科夫链，也叫马氏链（Markov Chain），马氏链模型是一类描述随机动态系统的模型，其特点是①系统每个时刻所处的状态都是随机的，②从一个时刻到下一个时刻的状态按照一定的概率转移，③下一个时刻的状态只取决于当前时刻的状态和转移概率，与其他时刻状态无关。

### 3.基于SVM的模型

支持向量机（SVM）是Vapnik和Cortes于1995年首先提出的，建立在统计学习理论的VC维理论和结构风险最小原理基础上的，它在解决小样本、非线性及高维模式识别中表现出许多特有的优势。支持向量机将非线性问题映射到高维空间，引入核函数，解决了非线性分类问题。支持向量回归（SVR）是支持向量机的推广，通过引入ε不敏感损失函数，将问题转化为通过对已知的样本数据学习找到一个拟合函数，对未知的数据进行预测，这个函数f(x)对实际的 值最大偏差为ε，从而构建回归模型。在金融领域的应用中，Trafalis和Ince研究发现SVR的预测精度远高于MLP（多层感知机）和ARIMA（差分滑动平均自回归模型），并且与神经网络相比有更加出色的性能。


### 4.基于XGBoost集成树模型

XGBoost算法是陈天奇博士于2016年提出的基于回归树的提升算法，在市场价格估计、高能物理事件分类、网络文本分类、客户行为分析等诸多机器学习任务中均表现了出色的性能，并且算法因其高度可扩展性和并行化能力，在大规模数据回归和分类任务上也有着优异的表现。2017年，Ren年将XGBoost与卷积神经网络结合，用于图像分类；同年，Chen将加权的XGBoost模型应用于雷达信号分类并取得了很好的效果。


### 5.基于深度学习的模型

近年来，深度学习方法在人工智能领域取得了突破性的进展，深度神经网络在图像识别、人脸检测与识别、语音识别、目标捕捉、机器翻译等多个领域都有长足的进步。一方面由于积累的数据量的提高，达到了深度学习所需要的量级，另一方面，机器运算性能的提升，也使深度学习方法有了硬件的基础。深度学习方法可以通过组合浅层次的特征形成更加抽象的高层特征表示，以发现数据的深层次隐含关系，通过多层神经网络的堆叠和激活函数的选取，可以更好地拟合复杂的非线性函数。由于市场规律的复杂性、市场价格的波动性、影响因素的多样性，仅仅依赖传统的策略分析和模型不足以应对这些挑战，而深度学习方法的引入，能够提高对这些问题的解决能力，训练出泛化能力更强的模型，对股票投资来说是具有重要的参考意义。

由于股价数据具有很强的时间关联性，我们自然想到使用LSTM（Long Short-Term Memory）或者GRU（Gated Recurrent Unit）模型挖掘股价数据在时间上的相关性。同时，中国股票市场受政策面影响很大，经济新闻和上市公司财报等文本数据也会成为股价波动的重要原因。目前研究者们普遍在股价数据的时间序列特征和经济金融信息文本特征两个大方面，使用深度学习模型对其进行预测和分析，也有学者综合以上两种特征，构造既包括技术面参数也包括基本面分析的股价特征向量，输入到模型进行学习，均取得了不错的效果，并有多种模型已经使用到荐股软件或者金融领域中。本文作为综述，只简单的介绍模型以及其基本原理，并期待相关模型能在论文和实验中表现出优秀的性能。


## 当前研究的局限性

1.在股票特征选择上，直接将股票的技术指标或者基本面指标作为训练数据，缺乏对特征的预处理和特征提取，造成特征冗余或者特征属性片面化，不利于模型发现和学习数据特征真实的意义。

2.在模型选择上，普遍应用单一模型进行预测，没有充分运用机器学习多种不同模型的优势，特征选择上按照经验做法或者行业普遍习惯，没有让计算机自主发现特征的规律，参数调优也依靠经验和已有的成功案例，没有让计算机根据预测结果自主探索参数空间的各种可能性。


## 本系统所要解决的主要问题和创新点

本系统所要解决的主要问题：

1.国内的研究者主要关注单一模型对股市预测任务的解决能力，国外研究者已经尝试通过多种机器学习模型对美股进行预测，并取得了不错的效果。选题所要解决的主要问题是多种模型之间参数的传递、调试以及全局学习率等参数的设置与调试，并尝试构建超参数空间，将超参数也作为训练数据，将传统机器学习从业者调参的经验通过机器学习的方式固定下来，以便于应对多种复杂的股价波动场景。

2.由于中国股市偏向于政策市场，与美股资本市场有较大区别，所以选题在数据特征选择方面对技术指标和政策面、基本面指标均有涉及，并尝试使用组合的特征向量对模型进行训练，以全面挖掘市场和政策信息对股价的影响。

3.对于基金投资公司和机构投资者而言，持股策略偏向稳重，不会在短期内高频交易，买卖时机更倾向于中长线。选题所选用的数据特征以及预期的预测结果更倾向于为机构投资者这样的用户使用，而不是为散户等高频交易人员使用。当然，模型本身也可以接受每分钟交易情况，并预测一日内股价涨跌，这个目标作为本选题的中长期目标，期待在后期进行实现。

创新点：

1.使用VAE、GAN等非监督生成模型对股价进行预测，而不是传统的非线性回归模型，这在国内的研究领域内还属于未被开垦的荒地。

2.使用DRL深度强化学习调整超参数，控制整体模型，并通过反复迭代逼近真实股价走势，这种方法在机器人控制、自动驾驶领域方兴未艾，AlphaGo、AlphaMaster等围棋人工智能也是基于马尔科夫链蒙特卡洛方法的强化学习模型进行训练的，目前国内外研究者还鲜有在其他领域进行迁移和尝试。选题尝试将其迁移至股价预测模型研究，并作为辅助的调参手段，期待其能自主探索机器学习最优的模型。

## 股票二级市场交易理论和模型假设

股票市场相关理论解读：http://www.iwencai.com/school/article?cateId=533&fcateId=1

趋势理论：http://www.iwencai.com/school/article?cateId=531&fcateId=1


**1.市场主体：股票二级市场的投资行为主体分为主力和散户两大类，主力拥有内部消息知情权，在投资上具有先于散户的优势，且主力盈利目的明确；散户以自我为中心，具备一定的交易策略，受政策、消息、新闻事件影响较大。**

**2.交易规则：股价高低决定于买卖关系，即卖出价<=买入价时，方可成交。如果买入订单数量大于卖出订单数量，即供不应求，则优先成交低价的卖出订单，实时股价随之上涨；如果卖出订单数量大于买入订单数量，即供大于求，则优先成交高价的买入订单，实时股价随之下跌。**

**3.竞价：实际股票交易过程中，投资者往往选择挂单的形式，即在某一价格上预定买卖订单，待股价涨跌至指定价格时订单成交。所以随着股价波动，在股价水平线上下分别挂有买和卖的订单，由交易所计算机撮合最大的一笔成交订单的股价作为当前的股价成交。也就是说，二级市场交易有趋多特性，尽可能多的促成交易。**

**4.投资行为：投资行为决定了股票价格，而影响投资行为的因素，除了主力在获取内部信息并制定了投资方案之外，还有外部信息造成的干扰，我们认为：在t时刻之前的信息流作为投资者决策的全部信息来源，信息价值随着delta(t-t0)而逐渐衰减，即历史信息的价值<=实时信息的价值。**

**5.理性假设：我们认为，投资者都是以营利为目的，不存在损己利他为目的的交易行为，而且投资行为趋向于理性，即投资行为趋向于营利概率大的方向进行实施。**

**6.风险理论：高风险高回报，存在投资者以冒险精神进行投资，即承担损失以获取长期或者超短期的回报。**

